{
  "id": "5",
  "title": "Tabelas Dinâmicas",
  "bigIdea": "Caleidoscópio de dados",
  "cover": "assets/images/modules/05/cover.svg",
  "lessons": [
    {
      "id": "5.1",
      "title": "Criar tabela dinâmica em 30 s",
      "illustration": "assets/images/modules/05/lessons/01-illust.svg",
      "illustrationAlt": "Excel PivotTable Fields pane showing Sales dragged to Rows and Values. Painel de Campos da Tabela Dinâmica do Excel a mostrar os campos Vendas arrastados para as áreas Linhas e Valores.",
      "theory": "A Tabela Dinâmica é como um caleidoscópio. Pega nos seus dados brutos, desorganizados, e com um simples 'rodar', permite-lhe ver os mesmos dados de inúmeras perspetivas, criando resumos e padrões instantaneamente, sem escrever uma única fórmula. É a ferramenta mais rápida para transformar dados em conhecimento.",
      "quickNote": "A melhor prática é formatar os dados como uma Tabela oficial ('Ctrl + T' (ou ⌘ + T no Mac)) primeiro. Isto garante que a Tabela Dinâmica reconhece novos dados ao atualizar. Se usar um intervalo normal, terá de usar 'Análise de Tabela Dinâmica' > 'Alterar Fonte de Dados'. Atalho para criar TD (Windows): Alt+N+V.",
      "examples": [
        {
          "title": "Exemplo 1 – O Básico",
          "description": "Criar a primeira Tabela Dinâmica.",
          "code": "1. Clique numa célula da sua tabela de dados.\n2. Vá ao separador 'Inserir (Insert)' > 'Tabela Dinâmica'.\n3. Confirme o intervalo e clique OK.\n4. Uma Tabela Dinâmica em branco é criada numa nova folha."
        },
        {
          "title": "Exemplo 2 – O Caso Comum",
          "description": "Fazer um resumo rápido de vendas por produto.",
          "code": "1. Com a Tabela Dinâmica criada, olhe para o painel 'Campos da Tabela Dinâmica' à direita.\n2. Arraste o campo 'Produto' para a área 'Linhas'.\n3. Arraste o campo 'Vendas' para a área 'Valores'.\n4. O resumo aparece instantaneamente."
        },
        {
          "title": "Exemplo 3 – A Armadilha",
          "description": "A Tabela Dinâmica não atualiza quando os dados de origem mudam.",
          "code": "PROBLEMA: Altera um valor na sua tabela de dados original, mas a Tabela Dinâmica permanece inalterada.\nSOLUÇÃO: Clique com o botão direito na Tabela Dinâmica e escolha 'Atualizar' (ou use o atalho Alt+F5 (Win) / ⌘+Alt+R (Mac))."
        }
      ],
      "quiz": [
        {
          "question": "Qual é o primeiro passo altamente recomendado antes de criar uma Tabela Dinâmica?",
          "options": ["Ordenar os dados por ordem alfabética", "Formatar os dados como Tabela oficial (Ctrl+T)", "Colocar todos os números a negrito", "Copiar os dados para o Word"],
          "correctAnswer": "Formatar os dados como Tabela oficial (Ctrl+T)",
          "feedback": "Formatar os dados como Tabela (Ctrl+T) é a melhor prática. Isto garante que a Tabela Dinâmica reconhece automaticamente novas linhas de dados quando é atualizada, tornando a sua análise dinâmica."
        },
        {
          "question": "Em que separador da Faixa de Opções se encontra o botão para inserir uma Tabela Dinâmica?",
          "options": ["Base", "Fórmulas", "Dados", "Inserir"],
          "correctAnswer": "Inserir",
          "feedback": "A Tabela Dinâmica é considerada um objeto que se insere na folha de cálculo, tal como um gráfico ou uma imagem. Por isso, a opção encontra-se no separador 'Inserir'."
        },
        {
          "question": "Se adicionar uma nova linha de vendas aos seus dados de origem, o que tem de fazer para que a Tabela Dinâmica a inclua?",
          "options": ["Nada, é automático", "Apagar e recriar a Tabela Dinâmica", "Clicar em 'Atualizar' na Tabela Dinâmica", "Guardar e reabrir o ficheiro"],
          "correctAnswer": "Clicar em 'Atualizar' na Tabela Dinâmica",
          "feedback": "As Tabelas Dinâmicas não se atualizam em tempo real. É necessário acionar uma atualização (clique direito > Atualizar, ou no separador 'Dados' > 'Atualizar Tudo') para que ela releia os dados de origem e mostre as alterações."
        }
      ],
      "challenge": {
        "description": "Dada uma pequena lista de vendas, insira uma Tabela Dinâmica numa nova folha. Para uma boa visibilidade, pode usar o estilo 'Estilo de Tabela Dinâmica Claro 1'. Bónus: Adicione uma nova linha de dados à sua tabela de origem e veja a Tabela Dinâmica atualizar-se com o atalho de teclado.",
        "initialCode": "Data | Vendedor | Valor\n01/01 | Ana | 100\n01/01 | Bruno | 150\n02/01 | Ana | 200",
        "solution": "1. (Recomendado) Selecione os dados e pressione Ctrl+T para os converter numa Tabela.\n2. Clique numa célula dos dados, vá a 'Inserir' > 'Tabela Dinâmica' e clique OK.\nBónus:\n1. Adicione uma nova linha de dados à tabela de origem.\n2. Clique na Tabela Dinâmica e pressione Alt+F5 (Win) ou ⌘+Alt+R (Mac) para ver a nova linha aparecer."
      },
      "glossary": [
        { "word": "Tabela Dinâmica / PivotTable", "def": "Relatório interactivo que resume dados." },
        { "word": "Campos / Fields", "def": "Nomes das colunas que se arrastam para áreas." },
        { "word": "Áreas / Areas", "def": "Linhas, Colunas, Valores, Filtros." },
        { "word": "Linhas / Rows", "def": "Categorias que aparecem em linhas." },
        { "word": "Valores / Values", "def": "Campos numéricos a agregar (soma, média, etc.)." },
        { "word": "Atualizar / Refresh", "def": "Alt + F5 (Win) / ⌘ + Alt + R (Mac)." },
        { "word": "Fonte de Dados / Data Source", "def": "Intervalo ou Tabela que alimenta a TD." },
        { "word": "Ctrl + T / Ctrl + T (Mac: ⌘ + T)", "def": "Cria Tabela oficial antes da TD." }
      ]
    },
    {
      "id": "5.2",
      "title": "Arrastar campos (linhas, colunas, valores)",
      "illustration": "assets/images/modules/05/lessons/02-illust.svg",
      "illustrationAlt": "Excel PivotTable with Product in Rows, Region in Columns, and Sales in Values. Tabela Dinâmica do Excel com Produto em Linhas, Região em Colunas e Vendas em Valores.",
      "theory": "O painel de campos da Tabela Dinâmica é o seu estúdio de DJ. Os campos (os cabeçalhos das suas colunas) são os discos. As quatro áreas (Filtros, Colunas, Linhas, Valores) são os pratos. Ao arrastar e misturar os 'discos' nos 'pratos', você cria um novo 'remix' dos seus dados, respondendo a diferentes perguntas a cada segundo.",
      "quickNote": "A área 'Valores' é tipicamente para campos numéricos. O Excel irá, por defeito, somá-los (Soma de...). Se arrastar um campo de texto, como 'Nome do Cliente', o Excel irá contá-lo (Contagem de...), o que é útil para saber quantos clientes compraram, por exemplo. Dica de teclado (Win): use Alt+JT+L para mostrar/ocultar o Painel de Campos.",
      "examples": [
        {
          "title": "Exemplo 1 – O Básico",
          "description": "Ver vendas totais por Vendedor.",
          "code": "1. Arraste o campo 'Vendedor' para a área 'Linhas (Rows)'.\n2. Arraste o campo 'Valor' para a área 'Valores (Values)'.\nResultado: A tabela lista cada vendedor e o seu total de vendas."
        },
        {
          "title": "Exemplo 2 – O Caso Comum",
          "description": "Criar uma matriz de vendas: Produto vs. Região.",
          "code": "1. Arraste 'Produto' para 'Linhas (Rows)'.\n2. Arraste 'Região' para 'Colunas (Columns)'.\n3. Arraste 'Vendas' para 'Valores (Values)'.\nResultado: Uma tabela de dupla entrada que cruza os dados."
        },
        {
          "title": "Exemplo 3 – A Armadilha",
          "description": "Arrastar um campo de data para a área de Valores.",
          "code": "PROBLEMA: Arrastar 'Data da Fatura' para a área 'Valores' resulta num número gigante e sem sentido (a soma dos números de série das datas).\nSOLUÇÃO: A área 'Valores' deve conter dados que fazem sentido agregar (somar, contar). Use datas nas áreas de Linhas, Colunas ou Filtros."
        }
      ],
      "quiz": [
        {
          "question": "Para que serve a área 'Linhas' do painel de campos?",
          "options": ["Para filtrar toda a tabela", "Para criar os cabeçalhos das colunas do seu resumo", "Para fazer os cálculos matemáticos", "Para criar os cabeçalhos das linhas do seu resumo"],
          "correctAnswer": "Para criar os cabeçalhos das linhas do seu resumo",
          "feedback": "Os campos colocados na área 'Linhas' criam as categorias no eixo vertical da Tabela Dinâmica, ou seja, os cabeçalhos de cada linha do seu relatório de resumo."
        },
        {
          "question": "Se arrastar um campo de texto (ex: Nomes) para a área 'Valores', que cálculo o Excel fará por defeito?",
          "options": ["Soma", "Média", "Contagem", "Erro"],
          "correctAnswer": "Contagem",
          "feedback": "Como não é possível realizar operações matemáticas com texto, o Excel assume que a sua intenção é contar o número de ocorrências, pelo que aplica a função de Contagem por defeito."
        },
        {
          "question": "Para criar uma tabela de dupla entrada (matriz), que duas áreas do painel de campos precisa de usar para os seus eixos?",
          "options": ["Linhas e Valores", "Valores e Filtros", "Linhas e Colunas", "Colunas e Filtros"],
          "correctAnswer": "Linhas e Colunas",
          "feedback": "Uma matriz, ou tabela de dupla entrada, é criada usando a área 'Linhas' para o eixo vertical e a área 'Colunas' para o eixo horizontal. A área 'Valores' preenche as intersecções."
        }
      ],
      "challenge": {
        "description": "A partir de uma Tabela Dinâmica, crie um relatório que mostre o total de vendas por Vendedor (linhas) e por Categoria de Produto (colunas). Bónus: introduzindo o tema da próxima lição, arraste o campo 'Vendas' uma segunda vez para a área de Valores e veja o que acontece.",
        "initialCode": "Vendedor | Categoria | Vendas\nAna | Tech | 500\nBruno | Mobiliário | 300\nAna | Mobiliário | 200",
        "solution": "1. Arraste 'Vendedor' para a área 'Linhas'. \n2. Arraste 'Categoria' para a área 'Colunas'. \n3. Arraste 'Vendas' para a área 'Valores'.\nBónus: Arraste 'Vendas' novamente para a área de Valores. A Tabela Dinâmica mostrará duas colunas de 'Soma de Vendas'. Na próxima lição, aprenderemos a transformar a segunda em percentagem."
      },
      "glossary": [
        { "word": "Painel de Campos / Field List", "def": "Janela onde se arrastam campos para áreas." },
        { "word": "Linhas / Rows", "def": "Área que gera cabeçalhos de linha no relatório." },
        { "word": "Colunas / Columns", "def": "Área que gera cabeçalhos de coluna no relatório." },
        { "word": "Valores / Values", "def": "Área onde se colocam campos a agregar (soma, contagem, etc.)." },
        { "word": "Filtros / Filters", "def": "Área que permite filtrar toda a TD." },
        { "word": "Arrastar / Drag", "def": "Acção de mover campos com o rato ou teclado." },
        { "word": "Contagem / Count", "def": "Agregação padrão quando se arrasta texto para Valores." },
        { "word": "Número de Série / Serial Number", "def": "Número inteiro que representa uma data no Excel." }
      ]
    },
    {
      "id": "5.3",
      "title": "Filtros de segmentação",
      "illustration": "assets/images/modules/05/lessons/03-illust.svg",
      "illustrationAlt": "Excel Slicer with Region buttons and Timeline for months. Segmentação de Dados do Excel com botões para Região e Linha de Tempo para meses.",
      "theory": "A Segmentação de Dados (Slicers) são filtros com estilo. Em vez de usar as listas pendentes aborrecidas nos cabeçalhos, a segmentação cria botões grandes e interativos que lhe permitem focar-se numa 'fatia' específica dos seus dados. São como o controlo remoto do seu caleidoscópio, permitindo-lhe mudar a vista com um clique e criar dashboards dinâmicos.",
      "quickNote": "Pode ligar uma única segmentação a MÚLTIPLAS Tabelas Dinâmicas (clique direito > 'Ligações de Relatório'). Esta é a base para dashboards interativos. Dica de teclado (Win): use Alt+JT+S para inserir uma segmentação rapidamente.",
      "examples": [
        {
          "title": "Exemplo 1 – O Básico",
          "description": "Adicionar uma segmentação por Região.",
          "code": "1. Selecione a sua Tabela Dinâmica.\n2. Vá ao separador 'Análise de Tabela Dinâmica (PivotTable Analyze)' > 'Inserir Segmentação de Dados (Insert Slicer)'.\n3. Escolha 'Região' e clique OK.\n4. Uma caixa com botões ('Norte', 'Sul', etc.) aparece. Clicar num botão filtra a tabela."
        },
        {
          "title": "Exemplo 2 – O Caso Comum",
          "description": "Usar uma Linha de Tempo (Timeline) (um tipo especial de segmentação para datas).",
          "code": "1. Selecione a sua Tabela Dinâmica.\n2. Vá a 'Análise de Tabela Dinâmica (PivotTable Analyze)' > 'Inserir Linha de Tempo (Timeline)'.\n3. Se tiver um campo de data, ele aparecerá. Selecione-o.\n4. Agora pode filtrar por ano, trimestre ou mês com uma barra de navegação visual."
        },
        {
          "title": "Exemplo 3 – A Armadilha",
          "description": "A segmentação mostra itens que já não existem nos dados.",
          "code": "PROBLEMA: Elimina um produto dos dados de origem, mas o botão desse produto ainda aparece na segmentação (acinzentado).\nSOLUÇÃO: Clique com o botão direito na segmentação > 'Definições da Segmentação de Dados' > desmarque 'Mostrar itens eliminados da origem de dados'."
        }
      ],
      "quiz": [
        {
          "question": "Onde encontra a opção para inserir uma Segmentação de Dados?",
          "options": ["No separador 'Dados'", "No separador contextual 'Análise de Tabela Dinâmica'", "No separador 'Inserir'", "Clicando com o botão direito numa célula"],
          "correctAnswer": "No separador contextual 'Análise de Tabela Dinâmica'",
          "feedback": "Ao selecionar uma Tabela Dinâmica, o separador contextual 'Análise de Tabela Dinâmica' aparece na Faixa de Opções. É aí que se encontram as ferramentas específicas como a Segmentação de Dados."
        },
        {
          "question": "Uma Segmentação de Dados pode controlar mais do que uma Tabela Dinâmica?",
          "options": ["Não, cada segmentação controla apenas uma tabela", "Sim, através da opção 'Ligações de Relatório'", "Sim, mas apenas se estiverem na mesma folha", "Apenas se controlar Gráficos Dinâmicos"],
          "correctAnswer": "Sim, através da opção 'Ligações de Relatório'",
          "feedback": "Sim, esta é uma das suas características mais poderosas para dashboards. Clicando com o botão direito na segmentação, a opção 'Ligações de Relatório' permite selecionar a que Tabelas (e Gráficos) Dinâmicos ela se deve aplicar."
        },
        {
          "question": "Qual é o nome do filtro especial, tipo segmentação, desenhado para trabalhar com campos de data?",
          "options": ["Segmentação de Datas", "Filtro de Calendário", "Linha de Tempo", "Painel de Datas"],
          "correctAnswer": "Linha de Tempo",
          "feedback": "A 'Linha de Tempo' é uma ferramenta visual de filtragem, similar a uma segmentação, mas concebida especificamente para campos de data, permitindo filtrar facilmente por anos, trimestres, meses ou dias."
        }
      ],
      "challenge": {
        "description": "Adicione uma Segmentação de Dados por 'Categoria' a uma Tabela Dinâmica de vendas. Mude o estilo da segmentação (no separador 'Segmentação') para ter 2 colunas de botões e uma cor que combine com a sua tabela (dica de alto contraste: use 'Estilo de Segmentação de Dados Claro 1'). Bónus: Crie uma Linha de Tempo (Timeline) e ligue-a à mesma Tabela Dinâmica.",
        "initialCode": "Tabela Dinâmica de vendas por produto",
        "solution": "1. Selecione a Tabela. \n2. Vá a 'Análise de Tabela Dinâmica' > 'Inserir Segmentação de Dados' > selecione 'Categoria'. \n3. Com a nova segmentação selecionada, vá ao separador 'Segmentação'. \n4. Mude o valor em 'Colunas' para 2. \n5. Escolha um estilo de cor diferente na galeria.\nBónus:\n1. Selecione a Tabela novamente.\n2. Vá a 'Análise de Tabela Dinâmica' > 'Inserir Linha de Tempo (Timeline)'.\n3. Selecione o campo de data e clique OK."
      },
      "glossary": [
        { "word": "Segmentação de Dados / Slicer", "def": "Botões visuais para filtrar TD." },
        { "word": "Linha de Tempo / Timeline", "def": "Segmentação especial para campos de data." },
        { "word": "Análise de Tabela Dinâmica / PivotTable Analyze", "def": "Separador contextual onde se insere segmentação." },
        { "word": "Ligações de Relatório / Report Connections", "def": "Liga uma segmentação a múltiplas TD." },
        { "word": "Mostrar Itens Eliminados / Show Items Deleted", "def": "Opção que mantém ou remove botões sem dados." },
        { "word": "Alt + JT + S", "def": "Atalho para inserir segmentação (Win)." },
        { "word": "Estilo / Style", "def": "Formato visual dos botões (cores, colunas)." },
        { "word": "Filtro / Filter", "def": "Acção de seleccionar ou desseleccionar botões." }
      ]
    },
    {
      "id": "5.4",
      "title": "Agrupar datas (mês, trimestre)",
      "illustration": "assets/images/modules/05/lessons/04-illust.svg",
      "illustrationAlt": "Excel PivotTable with dates grouped by Quarter and Year. Tabela Dinâmica do Excel com datas agrupadas por Trimestre e Ano.",
      "theory": "O Excel é muito inteligente com datas. Ele entende que dias pertencem a meses, meses a trimestres, e trimestres a anos. A função 'Agrupar' do seu caleidoscópio permite-lhe juntar automaticamente os seus dados de transações diárias em blocos de tempo maiores, revelando tendências sazonais e de longo prazo com apenas alguns cliques.",
      "quickNote": "Este agrupamento automático só funciona se a sua coluna de datas não tiver células em branco ou com texto. Todos os valores têm de ser datas válidas. Limpar os dados é sempre o primeiro passo. Dica de teclado (Win): use Alt+JT+G para abrir a janela de agrupamento.",
      "examples": [
        {
          "title": "Exemplo 1 – O Básico",
          "description": "Agrupar vendas diárias por Mês.",
          "code": "1. Numa Tabela Dinâmica com datas nas linhas, clique com o botão direito numa data.\n2. Escolha 'Agrupar'.\n3. Selecione 'Meses' e 'Anos' e clique OK.\n4. A tabela agora mostra um resumo de vendas por ano e mês."
        },
        {
          "title": "Exemplo 2 – O Caso Comum",
          "description": "Agrupar idades de clientes em faixas etárias.",
          "code": "1. Numa Tabela Dinâmica com idades, clique com o botão direito numa idade e escolha 'Agrupar'.\n2. Defina 'Começar em:' 18, 'Terminar em:' 70, e 'Por:' 10.\n3. O Excel cria automaticamente grupos como '18-27', '28-37', etc."
        },
        {
          "title": "Exemplo 3 – A Armadilha",
          "description": "Tentar agrupar uma coluna que o Excel não reconhece como data ou número.",
          "code": "PROBLEMA: A sua coluna de datas tem texto, como 'data a confirmar'.\nCONSEQUÊNCIA: Ao clicar com o botão direito, a opção 'Agrupar' está desativada ou devolve um erro.\nSOLUÇÃO: É preciso limpar os dados de origem primeiro, garantindo que são todas datas válidas."
        }
      ],
      "quiz": [
        {
          "question": "Que ação simples inicia o processo de agrupamento de datas numa Tabela Dinâmica?",
          "options": ["Ir ao separador 'Dados'", "Clicar duas vezes no cabeçalho", "Clicar com o botão direito numa data na área das linhas/colunas e escolher 'Agrupar'", "Usar uma fórmula"],
          "correctAnswer": "Clicar com o botão direito numa data na área das linhas/colunas e escolher 'Agrupar'",
          "feedback": "A funcionalidade de agrupamento é acedida através do menu de contexto. Clicar com o botão direito num campo de data ou número dentro da Tabela Dinâmica revela a opção 'Agrupar'."
        },
        {
          "question": "Além de datas, que outro tipo de dados pode ser agrupado numa Tabela Dinâmica para criar faixas?",
          "options": ["Texto", "Dados numéricos", "Valores lógicos (VERDADEIRO/FALSO)", "Não é possível agrupar outros tipos"],
          "correctAnswer": "Dados numéricos",
          "feedback": "A funcionalidade de agrupamento também se aplica a campos numéricos, permitindo criar faixas ou intervalos (ex: agrupar idades em décadas, preços em escalões)."
        },
        {
          "question": "O que acontece se a sua coluna de datas tiver uma única célula em branco no meio?",
          "options": ["O agrupamento funciona, mas ignora essa célula", "O Excel pede para preencher a célula", "O agrupamento falha com um erro", "O agrupamento funciona para os dados antes e depois da célula em branco"],
          "correctAnswer": "O agrupamento falha com um erro",
          "feedback": "Para que o agrupamento automático funcione, o campo (seja de data ou número) não pode conter células em branco ou com texto. O Excel precisa de um conjunto contínuo de dados válidos para conseguir criar os grupos."
        }
      ],
      "challenge": {
        "description": "A partir de uma lista de vendas com datas específicas ao longo de um ano, agrupe os dados para mostrar o total de vendas por Trimestre. Para uma boa visibilidade, pode usar o estilo 'Estilo de Tabela Dinâmica Claro 1'. Bónus: Numa outra Tabela Dinâmica com uma lista de idades, crie faixas etárias (ex: 20-29, 30-39) agrupando os valores numéricos.",
        "initialCode": "Data | Vendas\n15/01/2023 | 500\n20/03/2023 | 600\n10/05/2023 | 700\n05/08/2023 | 800",
        "solution": "1. Crie uma Tabela Dinâmica com 'Data' nas Linhas e 'Vendas' nos Valores. \n2. Clique com o botão direito em qualquer data na nova tabela. \n3. Escolha 'Agrupar'. \n4. Na janela de agrupamento, desmarque todas as opções exceto 'Trimestres' e 'Anos'. Clique em OK.\nBónus: Crie uma TD com idades nas linhas. Clique com o botão direito numa idade > Agrupar. Defina os limites 'Começar em' e 'Terminar em', e o tamanho da faixa em 'Por:' (ex: 10 para agrupar por décadas)."
      },
      "glossary": [
        { "word": "Agrupar / Group", "def": "Função que junta valores em blocos (datas ou números)." },
        { "word": "Trimestre / Quarter", "def": "Período de 3 meses (Q1, Q2, Q3, Q4)." },
        { "word": "Faixa / Bin", "def": "Intervalo numérico criado pelo agrupamento." },
        { "word": "Data Válida / Valid Date", "def": "Valor reconhecido como data pelo Excel." },
        { "word": "Célula em Branco / Blank Cell", "def": "Impede agrupamento se existir no intervalo." },
        { "word": "Alt+JT+G", "def": "Atalho para abrir janela de agrupamento (Win)." },
        { "word": "Começar em / Starting at", "def": "Limite inferior definido pelo utilizador na janela de agrupamento." },
        { "word": "Terminar em / Ending at", "def": "Limite superior definido pelo utilizador na janela de agrupamento." }
      ]
    },
    {
      "id": "5.5",
      "title": "Formato de valor & % do total",
      "illustration": "assets/images/modules/05/lessons/05-illust.svg",
      "illustrationAlt": "Excel PivotTable showing Sales as Currency and % of Grand Total side by side. Tabela Dinâmica do Excel a mostrar Vendas como Moeda e % do Total Geral lado a lado.",
      "theory": "A última volta no caleidoscópio é mudar a forma como os números são exibidos. Em vez de apenas somas, pode querer ver a média, ou, mais importante, ver um valor como uma percentagem de um total. Isto ajuda a contextualizar os números, respondendo a perguntas como 'Qual a contribuição deste produto para as vendas totais?' sem precisar de cálculos manuais.",
      "quickNote": "Arraste o mesmo campo (ex: 'Vendas') para a área de Valores VÁRIAS VEZES. Pode ter a 'Soma de Vendas' e, ao lado, a '% de Vendas' na mesma Tabela Dinâmica, mostrando o valor absoluto e o relativo em simultâneo. Dica de teclado (Win): use Alt+JT+J para abrir as 'Definições do Campo de Valor'.",
      "examples": [
        {
          "title": "Exemplo 1 – O Básico",
          "description": "Formatar os valores como Moeda.",
          "code": "1. Clique com o botão direito num valor da sua Tabela Dinâmica.\n2. Escolha 'Formato do Número...'\n3. Selecione 'Moeda' e clique OK."
        },
        {
          "title": "Exemplo 2 – O Caso Comum",
          "description": "Mostrar vendas por produto como uma percentagem do total geral (% of Grand Total).",
          "code": "1. Clique com o botão direito num valor.\n2. Escolha 'Mostrar Valores Como' > '% do Total Geral'.\n3. Agora vê a contribuição de cada produto para o total."
        },
        {
          "title": "Exemplo 3 – A Armadilha",
          "description": "Confundir '% do Total da Coluna' com '% do Total da Linha'.",
          "code": "Cenário: Produtos nas linhas, regiões nas colunas.\nObjetivo: Contribuição de cada produto para o total da sua região.\nSOLUÇÃO: Use 'Mostrar Valores Como' > '% do Total da Coluna'.\nSe usar '% do Total da Linha', verá a distribuição de um produto pelas várias regiões."
        }
      ],
      "quiz": [
        {
          "question": "Para mudar a forma como um valor é calculado (ex: de Soma para Média), onde deve clicar?",
          "options": ["No separador 'Fórmulas'", "Clicar na seta do campo na área 'Valores' > 'Definições do Campo de Valor'", "Clicar com o botão direito na célula > Formatar Células", "No menu 'Dados'"],
          "correctAnswer": "Clicar na seta do campo na área 'Valores' > 'Definições do Campo de Valor'",
          "feedback": "O painel 'Definições do Campo de Valor' é o centro de controlo para os cálculos da área 'Valores'. Permite alterar a função de agregação (Soma, Contagem, Média, etc.) e também aceder às opções de 'Mostrar Valores Como'."
        },
        {
          "question": "Qual a opção em 'Mostrar Valores Como' que usaria para ver o crescimento de vendas de um mês para o outro?",
          "options": ["Total Acumulado Em...", "'% do Total Geral'", "'% da Diferença De...'", "Classificar"],
          "correctAnswer": "'% da Diferença De...'",
          "feedback": "A opção '% da Diferença De...' calcula a variação percentual de um item em relação ao item anterior (ex: um mês em relação ao anterior), sendo ideal para análises de crescimento e tendências."
        },
        {
          "question": "É possível ter o valor absoluto e a percentagem do total para o mesmo campo na mesma Tabela Dinâmica?",
          "options": ["Não, só é possível um cálculo por campo", "Sim, arrastando o campo para a área de Valores duas vezes", "Sim, mas requer uma fórmula complexa", "Apenas em Gráficos Dinâmicos"],
          "correctAnswer": "Sim, arrastando o campo para a área de Valores duas vezes",
          "feedback": "Sim, pode arrastar o mesmo campo para a área 'Valores' múltiplas vezes. Depois, pode configurar cada instância de forma diferente: uma como soma, outra como '% do Total Geral', etc., enriquecendo a sua análise."
        }
      ],
      "challenge": {
        "description": "Este é o Desafio Final do Módulo! A partir de uma Tabela Dinâmica que mostra as vendas mensais, adicione duas colunas de cálculo: uma que mostre a contribuição de cada mês para o total anual (% do Total Geral) e outra que mostre o crescimento percentual face ao mês anterior (% da Diferença De...). Formate o valor de vendas original como Moeda.",
        "initialCode": "Tabela Dinâmica com Vendas mensais:\nMês | Soma de Vendas\nJan | 15.000€\nFev | 18.000€\nMar | 16.500€",
        "solution": "1. Arraste 'Vendas' para a área de Valores mais duas vezes. 2. Na primeira coluna, clique com o botão direito > 'Formato do Número...' > Moeda. 3. Na segunda, clique com o botão direito > 'Mostrar Valores Como' > '% do Total Geral'. 4. Na terceira, clique com o botão direito > 'Mostrar Valores Como' > '% da Diferença De...' (Baseado em: Mês, Item base: (anterior))."
      },
      "glossary": [
        { "word": "Definições do Campo de Valor / Value Field Settings", "def": "Janela onde se muda função (soma, média) e formato." },
        { "word": "Mostrar Valores Como / Show Values As", "def": "Transforma valores em percentagens, diferenças, etc." },
        { "word": "% do Total Geral / % of Grand Total", "def": "Percentagem face ao total geral da TD." },
        { "word": "% do Total da Coluna / % of Column Total", "def": "Percentagem face ao total da coluna." },
        { "word": "% da Diferença De… / % Difference From…", "def": "Crescimento percentual face ao item anterior." },
        { "word": "Total Acumulado / Running Total", "def": "Soma acumulada ao longo de linhas ou colunas." },
        { "word": "Moeda / Currency", "def": "Formato numérico com símbolo € e duas casas decimais." },
        { "word": "Alt + JT + J", "def": "Atalho para abrir Definições do Campo de Valor (Win)." }
      ]
    }
  ]
}